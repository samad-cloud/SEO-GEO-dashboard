name: CustomerReview
source: components/customer-review/customer-review.tsx
description: |
  Displays customer reviews section with heading, aggregate rating, star display,
  review count, and carousel of individual review cards. Configurable items per
  slide for different breakpoints.
exports:
  - default component

props:
  heading:
    type: string
    required: true
    description: Section heading text
  ratingText:
    type: string
    required: true
    description: Label text before rating value (e.g., "Rated")
  ratingValue:
    type: number
    required: true
    description: Aggregate rating (e.g., 4.5)
  reviewCount:
    type: number
    required: true
    description: Total number of reviews
  reviewString:
    type: string
    required: true
    description: Text after count (e.g., "reviews", localized)
  reviewModels:
    type: Array<CustomerReviewItem>
    required: true
    description: Array of individual review objects
  itemsPerSlideDesktop:
    type: number
    required: false
    default: 4
    description: Reviews to show per carousel slide on desktop
  itemsPerSlideTablet:
    type: number
    required: false
    default: 2
    description: Reviews to show per carousel slide on tablet
  itemsPerSlideMobile:
    type: number
    required: false
    default: 1
    description: Reviews to show per carousel slide on mobile
  titleAlignment:
    type: "left" | "center" | "right"
    required: false
    default: "center"
    description: Heading and rating alignment
  order:
    type: number
    required: true
    description: Display order on page

component_structure:
  - Section heading (h2) with configurable alignment
  - Rating summary line: ratingText + ratingValue + StarRating + reviewCount + reviewString
  - CustomerReviewCarousel component with reviewModels data
  - Responsive carousel configuration via itemsPerSlide* props

child_components:
  - CustomerReviewCarousel: Carousel for displaying review cards
  - StarRating: Displays star rating visualization for ratingValue

data_structure:
  CustomerReviewItem: (imported type)
    - Exact structure not defined in this file
    - Passed to CustomerReviewCarousel

behavior:
  - Heading alignment affects both h2 and rating summary div
  - "left" alignment adds: text-left ml-2 mb-4
  - "center" alignment (default): text-center
  - Rating summary always displayed as inline-flex for proper alignment
  - Review count formatted via formatNumber utility
  - StarRating component receives ratingValue prop
  - Carousel receives linkable: false, formatTime: false as fixed props

styling:
  - Heading: font-bold text-2xl mb-4
  - Rating summary: inline-flex flex-row items-center gap-4
  - Rating text: strong, mr-1 md:mr-2
  - Review count/string: standard span
  - Left alignment: text-left ml-2 mb-4 (heading and summary)
  - Center alignment: text-center (heading and summary)

dependencies:
  qwik:
    - component$ from @builder.io/qwik
  components:
    - CustomerReviewCarousel from ~/components/carousels/customer-review-carousel
    - CustomerReviewItem type from ../customer-review/customer-review-item
    - StarRating from ./star-rating
  utilities:
    - formatNumber from ~/utility/format

used_by: []

security:
  - Sanitize heading text if user-generated
  - Validate ratingValue is within expected range (0-5)
  - CustomerReviewItem content should be sanitized (contains user reviews)

notes:
  - Commented code shows previous Trustpilot branding (removed for non-GB sites)
  - order prop suggests this component is part of a sorted section array
  - Carousel props linkable: false and formatTime: false are hardcoded
  - formatNumber likely adds thousands separators (10,000 reviews)
  - titleAlignment flexibility suggests use in multiple page contexts
  - Typically used on homepage or product pages to build trust

# ── NEW SECTIONS (added in 2026-02-24 backfill) ───────────────────────────

types:
  CustomerReview:
    description: Component props interface (exported)
    fields:
      - name: heading
        type: string
      - name: ratingText
        type: string
      - name: ratingValue
        type: number
      - name: reviewCount
        type: number
      - name: reviewString
        type: string
      - name: reviewModels
        type: "Array<CustomerReviewItem>"
      - name: itemsPerSlideDesktop
        type: number
        optional: true
        default: 4
      - name: itemsPerSlideTablet
        type: number
        optional: true
        default: 2
      - name: itemsPerSlideMobile
        type: number
        optional: true
        default: 1
      - name: titleAlignment
        type: '"left" | "center" | "right"'
        optional: true
        default: '"center"'
      - name: order
        type: number

  CustomerReviewItem:
    description: Individual review data object (imported from customer-review-item.tsx)
    fields:
      - name: customerName
        type: string
      - name: heading
        type: string
      - name: review
        type: string
      - name: reviewID
        type: string
        optional: true
      - name: rate
        type: number
      - name: date
        type: string
      - name: verified
        type: boolean

field_consumption:
  CustomerReview:
    consumed:
      - heading: Rendered in h2 heading element
      - ratingText: Displayed as bold label before ratingValue
      - ratingValue: Displayed as number next to ratingText; passed to StarRating component
      - reviewCount: Passed to formatNumber() and rendered as text
      - reviewString: Rendered as text after formatted review count
      - reviewModels: Passed as data prop to CustomerReviewCarousel
      - itemsPerSlideDesktop: Forwarded to CustomerReviewCarousel
      - itemsPerSlideTablet: Forwarded to CustomerReviewCarousel
      - itemsPerSlideMobile: Forwarded to CustomerReviewCarousel
      - titleAlignment: Controls CSS class on h2 and rating summary div
    ignored:
      - order: Received as prop but not used in this component's render logic

visibility_map:
  heading_left_alignment:
    condition: "titleAlignment === 'left'"
    default: hidden
    notes: Adds 'text-left ml-2 mb-4' classes to h2 when titleAlignment is left
  heading_center_alignment:
    condition: "titleAlignment !== 'left' (default center)"
    default: visible
    notes: Adds 'text-center' class to h2 for center and right values
