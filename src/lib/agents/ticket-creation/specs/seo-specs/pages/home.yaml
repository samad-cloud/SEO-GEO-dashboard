url: "/"
layout: containerless
route_file: "src/routes/index@containerless.tsx"
route_spec: "../migration-specs/frontend/routes/home-page.yaml"

seo_contract:
  title:
    source: "homePageData.data.pageTitle"
    origin: "POST /homepage/getv2 → data.homepageViewModel.pageTitle"
    fallback: "'Printerpix' (if head resolver gets no data)"

  meta_description:
    source: "homePageData.data.metaDescription"
    origin: "POST /homepage/getv2 → data.homepageViewModel.metaDescription"

  meta_keywords:
    source: "homePageData.data.metaKeywords"
    origin: "POST /homepage/getv2 → data.homepageViewModel.metaKeywords"

  canonical:
    value: "{origin}/"
    logic: "getSiteSetting().website + '/'"
    example_GB: "https://www.printerpix.co.uk/"
    example_US: "https://www.printerpix.com/"

  robots:
    value: "index, follow"
    logic: "Hardcoded in head export — not driven by API isIndex field"

  open_graph:
    og_type: "Website"
    og_site_name: "PrinterPix"
    og_locale: "getSiteSetting().locale with '-' replaced by '_' (e.g., en_GB)"
    og_title: "homePageData.data.pageTitle"
    og_description: "homePageData.data.metaDescription"
    og_image: "First banner URL from homePageData.data.homepageBanners[0].bannerUrl, fallback to hardcoded printerpix.com image"
    og_url: "{origin}/"
    fb_app_id: "127030084070740"

  twitter:
    card: "summary_large_image"
    site: "@PrinterpixUS"
    title: "homePageData.data.pageTitle"
    description: "homePageData.data.metaDescription"
    image: "Same as og_image"

  other_meta:
    google_notranslate: true
    google_signin_client_id: "68686562698-qbaal2qdpbe5e16a9t0ms4dp3mtgtogs.apps.googleusercontent.com"
    google_site_verification: "lop5Y1yJWATbANf6eWBrhs5daBM2r5lHfQbguNwx2s0 (US region only)"

  structured_data:
    - type: "WebPage"
      description: "Schema.org WebPage with potentialAction ReadAction"
      fields:
        "@context": "https://schema.org"
        "@type": "WebPage"
        name: "homePageData.data.pageTitle"
        potentialAction:
          "@type": "ReadAction"
          target: "{origin}/"

    - type: "WebSite"
      description: "Schema.org WebSite with SearchAction for sitelinks search box"
      fields:
        "@context": "https://schema.org"
        "@type": "WebSite"
        url: "{origin}/"
        potentialAction:
          "@type": "SearchAction"
          target: "{origin}/search?q={search_term_string}"
          "query-input": "required name=search_term_string"

    - type: "FAQPage"
      description: "Generated by FaqSectionV2 component (via WebContentsComponent) — NOT in head export"
      source_component: "FaqSectionV2"
      notes: "Rendered as inline <script type='application/ld+json'> within the component, not via head export"

  hreflang:
    source: "getHreflangLinks('/')"
    count: 8
    links:
      - hreflang: "en-gb"
        href: "https://www.printerpix.co.uk/"
      - hreflang: "en-us"
        href: "https://www.printerpix.com/"
      - hreflang: "de-de"
        href: "https://www.printerpix.de/"
      - hreflang: "fr-fr"
        href: "https://www.printerpix.fr/"
      - hreflang: "it-it"
        href: "https://www.printerpix.it/"
      - hreflang: "es-es"
        href: "https://www.printerpix.es/"
      - hreflang: "nl-nl"
        href: "https://www.printerpix.nl/"
      - hreflang: "x-default"
        href: "https://www.printerpix.co.uk/"
    known_issues: "No i18n rewrite needed for '/' — same path across all regions"

  preloads:
    - type: "image"
      description: "First desktop banner image"
      source: "homePageData.data.homepageBanners[0].bannerUrl"
    - type: "image"
      description: "First mobile banner image"
      source: "homePageData.data.homepageBanners[0].mobileBannerUrl"

heading_hierarchy:
  h1:
    source: "homePageData.data.h1"
    origin: "POST /homepage/getv2 → data.homepageViewModel.h1"
    notes: "Rendered directly in the homepage component"
  h2_sources:
    - "FAQ section heading (via FaqSectionV2 → WebContentsComponent)"
    - "SEO content heading (via SeoContentComponent → WebContentsComponent)"
    - "Trust signals heading (via TrustSignalsSection → WebContentsComponent)"
    - "Best sellers heading (via HomeBestSellers → WebContentsComponent)"
    - "Customer reviews title (via HomeCustomerReviews or CustomerReview)"
  h3_sources:
    - "FAQ individual questions (via FaqSectionV2)"
    - "SEO content subheading (via SeoContentComponent)"
    - "Best sellers subheading (via HomeBestSellers)"

file_chain:
  route: "src/routes/index@containerless.tsx"
  layout: "src/routes/layout-containerless.tsx"
  data_services:
    - service: "home-service"
      file: "src/services/home-service.ts"
      function: "getHomepage()"
      endpoint: "POST /homepage/getv2"
      role: "Primary data fetcher — pageTitle, metaDescription, metaKeywords, h1, banners, associations, reviews, webComponents"
    - service: "homepage-service"
      file: "src/services/homepage-service.ts"
      function: "lazyLoading()"
      role: "Client-side scroll-based lazy loading for section progressive rendering"
    - service: "server"
      file: "src/services/server.ts"
      functions: ["getHreflangLinks('/')", "getSiteSetting()"]
      role: "Hreflang generation and region config"
    - service: "web-component-service"
      file: "src/services/web-component-service.ts"
      function: "processHomePageItemsOrderData()"
      role: "Processes CMS-driven section ordering"
    - service: "cart-services/gtm/data-layer-base"
      file: "src/services/cart-services/gtm/data-layer-base.ts"
      function: "extractGCLCookieData()"
      role: "Extracts gclId from _gcl_aw cookie for API request"
  static_data:
    - file: "src/utility/homepage-contents.ts"
      functions: ["getHome()", "getReviews()"]
      role: "Region-specific static JSON content (shopCollectionCtaText, review data)"
  components:
    orchestrator: "WebContentsComponent (renders CMS-driven sections)"
    key_children:
      - "DynamicCarousel — banner carousel with image alts and preloads"
      - "HomepageCategoryContainer — category grid with headings"
      - "HomeCustomerReviews — static review fallback (non-NL/GB)"
      - "CustomerReview — API-driven reviews"
      - "FaqSectionV2 — FAQ with JSON-LD structured data"
      - "SeoContentComponent — h2/h3 headings + markdown"
      - "TrustSignalsSection — trust badges with heading"
      - "HomeBestSellers — featured products grid"
      - "GuidelineSection — lazy-loaded on scroll"
      - "FooterContainerLess — full footer (via layout)"

api_verification:
  endpoint: "POST /homepage/getv2"
  base_url: "https://qt-api.printerpix.{tld}"
  method: POST
  content_type: "application/json"
  body_fields:
    machineToken: "required — visitor session token"
    couponCode: "optional — active coupon"
    gclId: "optional — Google Click ID from cookie"
    pixId: "optional — affiliate tracking ID"
    utm_params: "optional — all utm_* marketing parameters"
  seo_fields_in_response:
    pageTitle: "data.homepageViewModel.pageTitle"
    metaDescription: "data.homepageViewModel.metaDescription"
    metaKeywords: "data.homepageViewModel.metaKeywords"
    h1: "data.homepageViewModel.h1"
    homepageBanners: "data.homepageViewModel.homepageBanners[] (bannerUrl, mobileBannerUrl, bannerAltText, bannerNavUrl)"
    homepageAssociations: "data.homepageViewModel.homepageAssociations[] (category sections with headings, images)"
    webComponents: "data.webComponents[] (CMS sections — FAQ, SEO content, trust signals, etc.)"
    reviewsCollection: "data.reviewsCollection (ratingValue, ratingText, heading, reviews[])"
  example_curl: |
    curl -X POST "https://qt-api.printerpix.co.uk/homepage/getv2" \
      -H "Content-Type: application/json" \
      -H "machine-token: c2e1ccba-0df5-4a76-9c5d-bbb6682e93f9" \
      -d '{"machineToken": "c2e1ccba-0df5-4a76-9c5d-bbb6682e93f9", "couponCode": "", "gclId": "", "pixId": ""}'
  notes: |
    - This is a SEPARATE endpoint from /CategoryAndProductPage/GetByFriendlyUrlForQwikV2
    - Response structure differs: data.homepageViewModel (not data.metaData)
    - No URL parameter needed (unlike product/category endpoint)
    - All params go in POST body

region_variations:
  review_rendering:
    description: "Customer reviews have two rendering modes"
    api_driven:
      condition: "homePageData.reviewsCollection is truthy"
      component: "CustomerReview"
      source: "API response reviewsCollection"
    static_fallback:
      condition: "homePageData.reviewsCollection is falsy AND region is NOT NL or GB"
      component: "HomeCustomerReviews"
      source: "Static JSON from ~/utility/homepage-contents (getReviews())"
    skipped_regions:
      - NL
      - GB
      notes: "NL and GB skip fallback reviews entirely when reviewsCollection is null"
  static_content:
    description: "Some homepage content comes from static JSON files, varying by region"
    source: "~/utility/homepage-contents.ts — getHome(), getReviews()"
    fields: ["shopCollectionCtaText", "reviewData", "title", "ratingText", "ratingValue", "reviewCount"]
  section_ordering:
    description: "Section display order is CMS-driven"
    source: "WebComponent with wcTemplateName starting with 'Home Page Items Order'"
    fallback: "{trustIcons: 2, reviews: 6, categories: 10, guidelineSection: 18, goQuickWidget: 3}"
    mechanism: "CSS order property on wrapper divs"
